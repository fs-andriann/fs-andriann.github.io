<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Konverter winmail.dat ke ZIP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6f42c1;
            --secondary-color: #20c997;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
            --error-color: #dc3545;
            --success-color: #28a745;
        }
        
        body {
            background-color: #f5f7fb;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding-bottom: 2rem;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 0.5rem 1.5rem rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .drop-zone {
            border: 3px dashed #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--primary-color);
            background-color: rgba(111, 66, 193, 0.05);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            padding: 10px 20px;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background-color: #5a32a3;
            border-color: #5a32a3;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            padding: 10px 20px;
            font-weight: 600;
        }
        
        .btn-success:hover {
            background-color: #199d7a;
            border-color: #199d7a;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .progress {
            height: 12px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .progress-bar {
            border-radius: 10px;
        }
        
        .file-info {
            background-color: #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .step-number {
            display: inline-block;
            width: 32px;
            height: 32px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            margin-right: 10px;
            font-weight: bold;
        }
        
        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 15px;
            text-align: center;
            margin-top: 20px;
        }
        
        .alert-box {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .alert-error {
            background-color: #ffe6e6;
            color: var(--error-color);
            border-left: 4px solid var(--error-color);
        }
        
        .alert-success {
            background-color: #e6ffe6;
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }
        
        .history-item {
            border-left: 3px solid var(--primary-color);
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            border-radius: 0 5px 5px 0;
        }
        
        .feature-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
        }
        
        .tooltip-icon {
            cursor: pointer;
            color: var(--primary-color);
        }
        
        @media (max-width: 768px) {
            .drop-zone {
                min-height: 150px;
                padding: 20px;
            }
            
            .header {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container my-4">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card">
                    <div class="header">
                        <h1><i class="fas fa-file-archive me-2"></i>Konverter winmail.dat ke ZIP</h1>
                        <p class="mb-0">Ubah file winmail.dat yang bermasalah menjadi file ZIP yang dapat diakses</p>
                    </div>
                    
                    <div class="card-body">
                        <!-- Alert Boxes -->
                        <div id="errorAlert" class="alert-box alert-error">
                            <i class="fas fa-exclamation-circle me-2"></i><span id="errorMessage"></span>
                        </div>
                        
                        <div id="successAlert" class="alert-box alert-success">
                            <i class="fas fa-check-circle me-2"></i><span id="successMessage"></span>
                        </div>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="drop-zone" id="dropZone">
                                    <i class="fas fa-cloud-upload-alt feature-icon"></i>
                                    <h5>Seret dan Lepaskan File di Sini</h5>
                                    <p class="text-muted">atau</p>
                                    <button class="btn btn-primary btn-lg" id="browseBtn">
                                        <i class="fas fa-folder-open me-2"></i>Pilih File
                                    </button>
                                    <input type="file" id="fileInput" accept=".dat" hidden>
                                    <p class="text-muted mt-2 small">Hanya file .dat yang didukung</p>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <h4><i class="fas fa-info-circle me-2"></i>Cara Menggunakan:</h4>
                                <ol class="list-group list-group-numbered">
                                    <li class="list-group-item border-0">Pilih atau seret file winmail.dat ke area yang disediakan</li>
                                    <li class="list-group-item border-0">Tunggu hingga proses konversi selesai</li>
                                    <li class="list-group-item border-0">Unduh file ZIP hasil konversi</li>
                                </ol>
                                
                                <div class="mt-4">
                                    <h5><i class="fas fa-file me-2"></i>Informasi File:</h5>
                                    <div class="file-info">
                                        <p id="fileName"><i class="fas fa-file me-2"></i>Nama file: -</p>
                                        <p id="fileSize"><i class="fas fa-weight-hanging me-2"></i>Ukuran: -</p>
                                        <p id="fileType"><i class="fas fa-tag me-2"></i>Tipe: -</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress mb-3" id="progressBar" style="display: none;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-success btn-lg py-3" id="convertBtn" disabled>
                                <i class="fas fa-cog me-2"></i>Konversi ke ZIP
                            </button>
                            <a class="btn btn-primary btn-lg py-3" id="downloadBtn" style="display: none;" download>
                                <i class="fas fa-download me-2"></i>Unduh File ZIP
                            </a>
                        </div>
                    </div>
                    
                    <div class="card-footer bg-white">
                        <h4><i class="fas fa-history me-2"></i>Riwayat Konversi</h4>
                        <div id="conversionHistory" class="mt-3">
                            <p class="text-muted">Belum ada riwayat konversi</p>
                        </div>
                    </div>
                    
                    <footer>
                        <p class="mb-0">&copy; 2023 Konverter winmail.dat. All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-md-4 mb-3">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-shield-alt feature-icon"></i>
                        <h5>Privasi Terjaga</h5>
                        <p class="text-muted">Semua proses konversi dilakukan di peramban Anda. File tidak dikirim ke server manapun.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-bolt feature-icon"></i>
                        <h5>Konversi Cepat</h5>
                        <p class="text-muted">Proses konversi yang cepat dan efisien, bahkan untuk file berukuran besar.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-3">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-lock-open feature-icon"></i>
                        <h5>Akses Mudah</h5>
                        <p class="text-muted">Antarmuka yang intuitif dan mudah digunakan, tidak memerlukan instalasi software.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const progressBar = document.getElementById('progressBar');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const fileType = document.getElementById('fileType');
            const errorAlert = document.getElementById('errorAlert');
            const errorMessage = document.getElementById('errorMessage');
            const successAlert = document.getElementById('successAlert');
            const successMessage = document.getElementById('successMessage');
            const conversionHistory = document.getElementById('conversionHistory');
            
            let selectedFile = null;
            
            // Event listeners untuk drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropZone.classList.add('dragover');
            }
            
            function unhighlight() {
                dropZone.classList.remove('dragover');
            }
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }
            
            browseBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', () => {
                handleFiles(fileInput.files);
            });
            
            function handleFiles(files) {
                hideAlerts();
                
                if (files.length === 0) return;
                
                if (files.length > 1) {
                    showError('Harap pilih hanya satu file');
                    return;
                }
                
                selectedFile = files[0];
                
                // Validasi file
                if (!selectedFile.name.toLowerCase().endsWith('.dat')) {
                    showError('Hanya file dengan ekstensi .dat yang didukung');
                    selectedFile = null;
                    return;
                }
                
                if (selectedFile.size > 50 * 1024 * 1024) { // 50MB limit
                    showError('Ukuran file terlalu besar. Maksimal 50MB');
                    selectedFile = null;
                    return;
                }
                
                updateFileInfo(selectedFile);
                convertBtn.disabled = false;
                showSuccess('File berhasil dipilih. Klik "Konversi ke ZIP" untuk melanjutkan.');
            }
            
            function updateFileInfo(file) {
                fileName.textContent = `Nama file: ${file.name}`;
                fileSize.textContent = `Ukuran: ${formatFileSize(file.size)}`;
                fileType.textContent = `Tipe: ${file.type || 'tidak diketahui'}`;
            }
            
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            function showError(message) {
                errorMessage.textContent = message;
                errorAlert.style.display = 'block';
                
                // Sembunyikan setelah 5 detik
                setTimeout(hideAlerts, 5000);
            }
            
            function showSuccess(message) {
                successMessage.textContent = message;
                successAlert.style.display = 'block';
                
                // Sembunyikan setelah 5 detik
                setTimeout(hideAlerts, 5000);
            }
            
            function hideAlerts() {
                errorAlert.style.display = 'none';
                successAlert.style.display = 'none';
            }
            
            convertBtn.addEventListener('click', convertFile);
            
            function convertFile() {
                if (!selectedFile) {
                    showError('Tidak ada file yang dipilih');
                    return;
                }
                
                // Nonaktifkan tombol konversi selama proses
                convertBtn.disabled = true;
                
                // Tampilkan progress bar
                progressBar.style.display = 'block';
                const progressBarInner = progressBar.querySelector('.progress-bar');
                
                // Simulasi proses konversi
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.floor(Math.random() * 10) + 1;
                    if (progress > 100) progress = 100;
                    
                    progressBarInner.style.width = `${progress}%`;
                    progressBarInner.setAttribute('aria-valuenow', progress);
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        
                        // Proses konversi selesai
                        try {
                            createDemoZip(selectedFile);
                            showSuccess('Konversi berhasil! File ZIP siap diunduh.');
                            addToHistory(selectedFile);
                        } catch (error) {
                            showError('Terjadi kesalahan selama konversi: ' + error.message);
                            convertBtn.disabled = false;
                        }
                    }
                }, 200);
            }
            
            function createDemoZip(file) {
                // Membuat ZIP file demo (dalam implementasi nyata, ini akan memproses winmail.dat)
                const zip = new JSZip();
                
                // Menambahkan file asli ke ZIP (dalam implementasi nyata, ini akan mengekstrak konten dari winmail.dat)
                zip.file("README.txt", "File ini adalah hasil konversi dari winmail.dat. Dalam implementasi nyata, file asli akan diproses dan kontennya akan diekstrak.");
                
                // Menambahkan informasi file asli
                zip.file("original_file_info.txt", `Nama file asli: ${file.name}\nUkuran: ${file.size} bytes\nTanggal konversi: ${new Date().toLocaleString()}`);
                
                // Generate ZIP file
                zip.generateAsync({type: "blob"})
                .then(function(content) {
                    // Buat URL untuk file ZIP
                    const zipUrl = URL.createObjectURL(content);
                    
                    // Tampilkan tombol download
                    downloadBtn.href = zipUrl;
                    downloadBtn.download = file.name.replace('.dat', '') + '.zip';
                    downloadBtn.style.display = 'block';
                    
                    // Scroll ke tombol download
                    downloadBtn.scrollIntoView({behavior: 'smooth'});
                })
                .catch(function(error) {
                    showError('Terjadi kesalahan saat membuat file ZIP: ' + error.message);
                    convertBtn.disabled = false;
                });
            }
            
            function addToHistory(file) {
                // Hapus pesan default jika ada
                if (conversionHistory.querySelector('p.text-muted')) {
                    conversionHistory.innerHTML = '';
                }
                
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="d-flex justify-content-between">
                        <strong>${file.name}</strong>
                        <span class="text-muted">${new Date().toLocaleTimeString()}</span>
                    </div>
                    <div class="text-muted small">${formatFileSize(file.size)} → ${formatFileSize(file.size * 0.9)} (estimasi)</div>
                `;
                
                conversionHistory.prepend(historyItem);
            }
            
            // Menambahkan animasi pada elemen
            const card = document.querySelector('.card');
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 100);
        });
    </script>
</body>
</html>
