<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Konverter winmail.dat ke ZIP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6f42c1;
            --secondary-color: #20c997;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
        }
        
        body {
            background-color: #f5f7fb;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 15px 15px 0 0;
            padding: 20px;
        }
        
        .drop-zone {
            border: 3px dashed #ccc;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f8f9fa;
        }
        
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--primary-color);
            background-color: rgba(111, 66, 193, 0.05);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: #5a32a3;
            border-color: #5a32a3;
        }
        
        .btn-success {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .btn-success:hover {
            background-color: #199d7a;
            border-color: #199d7a;
        }
        
        .progress {
            height: 10px;
            border-radius: 5px;
        }
        
        .file-info {
            background-color: #e9ecef;
            border-radius: 5px;
            padding: 15px;
        }
        
        .feature-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
        }
        
        footer {
            background-color: var(--dark-color);
            color: white;
            border-radius: 0 0 15px 15px;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card">
                    <div class="header text-center">
                        <h1><i class="fas fa-file-archive me-2"></i>Konverter winmail.dat ke ZIP</h1>
                        <p class="mb-0">Ubah file winmail.dat yang bermasalah menjadi file ZIP yang dapat diakses</p>
                    </div>
                    
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="drop-zone" id="dropZone">
                                    <i class="fas fa-cloud-upload-alt feature-icon"></i>
                                    <h5>Seret dan Lepaskan File di Sini</h5>
                                    <p class="text-muted">atau</p>
                                    <button class="btn btn-primary btn-lg" id="browseBtn">
                                        <i class="fas fa-folder-open me-2"></i>Pilih File
                                    </button>
                                    <input type="file" id="fileInput" accept=".dat" hidden>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <h4>Cara Menggunakan:</h4>
                                <ol class="list-group list-group-numbered">
                                    <li class="list-group-item border-0">Pilih atau seret file winmail.dat ke area yang disediakan</li>
                                    <li class="list-group-item border-0">Tunggu hingga proses konversi selesai</li>
                                    <li class="list-group-item border-0">Unduh file ZIP hasil konversi</li>
                                </ol>
                                
                                <div class="mt-4">
                                    <h5>Informasi File:</h5>
                                    <div class="file-info">
                                        <p id="fileName">Nama file: -</p>
                                        <p id="fileSize">Ukuran: -</p>
                                        <p id="fileType">Tipe: -</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress mb-3" id="progressBar" style="display: none;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-success btn-lg" id="convertBtn" disabled>
                                <i class="fas fa-cog me-2"></i>Konversi ke ZIP
                            </button>
                            <a class="btn btn-primary btn-lg" id="downloadBtn" style="display: none;" download>
                                <i class="fas fa-download me-2"></i>Unduh File ZIP
                            </a>
                        </div>
                    </div>
                    
                    <footer class="text-center py-3">
                        <p class="mb-0">&copy; 2023 Konverter winmail.dat. All rights reserved.</p>
                    </footer>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const progressBar = document.getElementById('progressBar');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const fileType = document.getElementById('fileType');
            
            let selectedFile = null;
            
            // Event listeners untuk drag and drop
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropZone.classList.add('dragover');
            }
            
            function unhighlight() {
                dropZone.classList.remove('dragover');
            }
            
            dropZone.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles(files);
            }
            
            browseBtn.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', () => {
                handleFiles(fileInput.files);
            });
            
            function handleFiles(files) {
                if (files.length > 0) {
                    selectedFile = files[0];
                    updateFileInfo(selectedFile);
                    convertBtn.disabled = false;
                }
            }
            
            function updateFileInfo(file) {
                fileName.textContent = `Nama file: ${file.name}`;
                fileSize.textContent = `Ukuran: ${formatFileSize(file.size)}`;
                fileType.textContent = `Tipe: ${file.type || 'tidak diketahui'}`;
            }
            
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            convertBtn.addEventListener('click', convertFile);
            
            function convertFile() {
                if (!selectedFile) return;
                
                // Tampilkan progress bar
                progressBar.style.display = 'block';
                const progressBarInner = progressBar.querySelector('.progress-bar');
                
                // Simulasi proses konversi
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 5;
                    progressBarInner.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        
                        // Proses konversi selesai
                        // Dalam implementasi nyata, di sini akan dilakukan konversi sebenarnya
                        // Untuk demo, kita akan membuat file ZIP contoh
                        createDemoZip(selectedFile);
                    }
                }, 100);
            }
            
            function createDemoZip(file) {
                // Membuat ZIP file demo (dalam implementasi nyata, ini akan memproses winmail.dat)
                const zip = new JSZip();
                
                // Menambahkan file asli ke ZIP (dalam implementasi nyata, ini akan mengekstrak konten dari winmail.dat)
                zip.file("README.txt", "File ini adalah hasil konversi dari winmail.dat. Dalam implementasi nyata, file asli akan diproses dan kontennya akan diekstrak.");
                
                // Menambahkan informasi file asli
                zip.file("original_file_info.txt", `Nama file asli: ${file.name}\nUkuran: ${file.size} bytes`);
                
                // Generate ZIP file
                zip.generateAsync({type: "blob"})
                .then(function(content) {
                    // Buat URL untuk file ZIP
                    const zipUrl = URL.createObjectURL(content);
                    
                    // Tampilkan tombol download
                    downloadBtn.href = zipUrl;
                    downloadBtn.download = file.name.replace('.dat', '') + '.zip';
                    downloadBtn.style.display = 'block';
                    
                    // Scroll ke tombol download
                    downloadBtn.scrollIntoView({behavior: 'smooth'});
                });
            }
            
            // Menambahkan animasi pada elemen
            const card = document.querySelector('.card');
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 100);
        });
    </script>
</body>
</html>
